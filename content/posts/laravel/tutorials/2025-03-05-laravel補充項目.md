---
title: "laravel 補充項目"
date: 2025-03-05 10:30:00 +0800
categories: 
  - laravel
tags:
  - laravel
---

課程中學習到的一些事項，尚未撰寫專文，記載在此。

## route

### 建立 Resource Controller 和 API Controller

Laravel 提供 Resource Controller 和 API Controller 二種預設 Controller 類型，內建 Action Method，可以讓我們快速綁定 route。

```bash
# 建立 Resource Controller
php artisan make:controller BookController --resource

# 建立 API Controller
php artisan make:controller EventController --api
```

{{< alert type="notice" >}}
二者主要的差別：
Resource Controller 包含 CRUD 和 Redner 頁面的 Action Methods。  
API Controller 僅包含 CRUD 的 Action Methods。
{{< /alert >}}

### 建立 API Route

Laravel 11 與之前版本比起來，進行了部分項目的輕量化，因此若要使用 Laravel 的 API Route，則可使用以下指令安裝。

```bash
php artisan install:api
```

## Controller

### Scoping Resource Route

當使用 Laravel 的 Resource Controller 或 API Controller 機制，若應用在有關連的 Model 情況下，例如 Model Binding 有 ParentModel 和 ChildModel 的關聯，則可以在 Route 設定 Resource Controller 時，使用 scoped() 方法，限定 $ChildModel 必須是屬於 $ParentModel。

```php
Route::apiResource('events.attendees', AttendeeController::class)
    ->scoped(['attendee' => 'event']);
```

以上會產生類似如下的 route map：

GET|HEAD api/events/{event}/attendees/{attendee} .......................... events.attendees.show > Api\AttendeeController@show

PUT|PATCH api/events/{event}/attendees/{attendee} ...................... events.attendees.update > Api\AttendeeController@update

DELETE api/events/{event}/attendees/{attendee} .................... events.attendees.destroy > Api\AttendeeController@destroy

在 Route 設定 `scoped(['attendee' => 'event'])` 則可以確保 {attendee} 所綁定的 Model 必定會屬於 {event} 的 Model。  
簡單來說就是在查詢 attendees 資料列時，attendees.event_id 必須是屬於 {event} 所代表的 event 的 id，否則將會發生錯誤。
